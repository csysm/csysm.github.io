
<!DOCTYPE html>
<html lang="zh-cn">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="浅笑&#39;s blog">
    <title>DDD领域驱动设计 - 浅笑&#39;s blog</title>
    <meta name="author" content="浅笑">
    
    
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"浅笑","sameAs":[],"image":"author.jpg"},"articleBody":"DDD思想的简单介绍和参考。\n1.聚合\n一个聚合(Aggregate)包含一个聚合根实体，和尽可能少的与聚合根关系紧密的普通实体，如订单(聚合根)和订单明细(普通实体)。聚合间只通过聚合根来沟通。\n2.领域服务与应用服务\n虽然DDD的出现早于微服务架构的兴起，但其天生适合应用于微服务架构。理想情况下一个微服务中只应该包含一个聚合，并对应一个数据库。微服务间即聚合间通过事件总线或消息中间件沟通。\n在一个微服务中可能有以下三种服务：\n\n实体中的逻辑代码：管理实体的创建，实体的状态等非业务逻辑\n\n领域服务：聚合内的业务逻辑\n\n应用服务：聚合间、聚合与外部系统(数据库)的业务逻辑。应用服务协调多个领域服务、外部系统来完成一个用例。\n\n\nDDD典型用例的处理流程\n准备业务操作所需的数据\n执行一个或者多个领域模型做出的业务操作，这些操作会修改实体状态，或者生成一些操作结果\n把对实体的改变或操作结果应用于外部系统\n\n职责划分\n领域模型与外部系统之间不会交互，即领域服务不会涉及数据库操作\n业务逻辑放入领域服务，而与外部系统的交互由应用服务来负责\n领域服务不是必须的，在一些简单的业务处理中(如直接增删查)是没有领域操作的，这种情况下应用服务可以完成所有操作，不需要引入领域服务。这样可以避免过度设计。\n\n仓储(Repository)和工作单元(Unit  Of  Work)仓储负责安装要求从数据库或其他外部系统中读取数据，以及把领域服务修改的数据保存回数据库\n聚合内的数据操作是关系非常紧密的，我们要保证事务的强一致性，而聚合间的协作是关系不紧密的，因此我们只要保证事务的最终一致性即可。\n聚合内的若干相关联操作组成一个工作单元，这些工作单元要么全部成功，要么全部失败，类似于事务。\n3.领域事件与集成事件\nDDD中的事件分为两种类型：\n\n领域事件：\n在同一个微服务内的聚合之间的事件传递，使用进程内通信机制(MediatR)完成\n\n集成事件：\n跨微服务的事件传递，使用事件总线实现（RabbitMQ,Kafka等）\n\n\n4.贫血模型与充血模型\n贫血模型：一个类中只有属性或成员变量，没有方法\n充血模型：一个类中既有属性，成员变量，也有方法\n在EFCore中充血模型实现的要求要求：\n\n属性是只读的或者是只能被内部的代码修改\n实现：把属性的set定义为private set或init，然后通过构造方法为这些属性赋值\n\n定义有参数的构造方法，和一个私有的无参构造方法给EFCore使用\n实现：实体类中不定义无参构造方法，只定义有意义的有参构造方法。但是要求构造方法中的参数的名字和属性一致(参数开头小写，属性开头大写)\n\n有的成员变量没有对应属性，但是这些成员变量需要映射为数据表中的列，也就是我们需要把私有成员变量映射到数据表中的列\n实现：不是属性的成员变量映射为数据列只需要在Config中配置：builder.Property(&quot;成员变量名&quot;)\n\n有的属性是只读的，也就是它的值是从数据库中读取出来，我们不能修改属性值\n实现：EFCore中提供了”支持字段”(backing field)来支持这种写法：在配置实体类的代码中,使用HasField(&quot;成员变量名&quot;)来配置属性\n\n有的属性不需要映射到数据列，仅在运行时被使用\n实现：使用Ignore()来配置忽略这个属性\n\n\n5.EFCore中使用值对象\n使用enum在实体类中可以使用enum，如下：\n12345678910public class Entity&#123;    public int Id &#123;get;set;&#125;    public CurrencyName Currency &#123;get;set;&#125;&#125;enum CurrencyName&#123;    CNY,    USD,    NZD&#125;\n\n不需要额外配置，直接迁移数据库即可。生成的数据库表如下，会将枚举类型作为int\n\n    \n        字段名\n        Id\n        Currency\n    \n    \n        数据类型\n        int\n        int\n    \n\n\n可以在FluentApi中配置，将枚举类型中的值以字符串而不是int类型生成数据库，这样数据库中对应枚举的字段会保存枚举中的字符而不是0,1,2…，该字段类型也会变成nvarchar\n1234567public class EntityConfig:IEntityTypeConfigration&lt;Entity&gt;&#123;    public void Configure(EntityTypeBuilder&lt;Entity&gt; builder)    &#123;    \tbuilder.Property(e=&gt;e.Currency).HasConversion&lt;string&gt;();//将Currency保存为string而不是默认int    &#125;&#125;\n\n使用值对象例如有一个值对象：Geo。在DDD概念中值对象不能单独存在，需要依附于某个实体\n1234567891011public record Geo&#123;    public double Latitude &#123;get;init;&#125;//经度    public double Longitude &#123;get;init;&#125;//维度        public Geo(double Latitude,double Longitude)    &#123;        this.Latitude=Latitude;        this.Longitude=Longitude;    &#125;&#125;\n\nGeo值对象依附于Shop实体。\n1234567public class Shop&#123;    public int Id &#123;get;set;&#125;    public string Name &#123;get;set;&#125;        public Geo Location &#123;get;set;&#125;&#125;\n\n需要使用FluentApi配置：\n1234567public class ShopConfig:IEntityTypeConfigration&lt;Shop&gt;&#123;    public void Configure(EntityTypeBuilder&lt;Shop&gt; builder)    &#123;    \tbuilder.OwnsOne(x=&gt;x.Location);//使用OwnsOne配置    &#125;&#125;\n\n迁移后生成的数据库表会将值对象Geo中的两个属性展开，作为Shop表的两个字段\n\n    \n        字段名\n        Id\n        Name\n        Latitude\n        Longitude\n    \n    \n        数据类型\n        int\n        string\n        double\n        double\n    \n## 6.DDD在EFCore中的实现\n\n\n\n\n在聚合根实体中定义对聚合内所有实体进行操作的方法\n\n只在DbContext中为聚合根注册DbSet，EFCore会为与聚合根关联的实体自动生成数据库表\n\n建议将一个微服务中的所有聚合放在一个DbContext中，而不是为每个聚合单独创建一个DbContext，这样可以避免跨DbContext进行操作\n\n建议定义一个IAggregateRoot接口，所有聚合根实现该接口\n\n跨聚合进行实体引用，只能引用聚合根实体，并且只能引用根实体的主键作为外键，而不是根实体对象。这样便于以后拆分微服务，因为一般每个微服务都管理自己的数据库。此外，聚合内的实体进行关联所需的数据库外键可以保留，而聚合间因为跨数据库所以天生不存在外键关联。\n例如，User与UserLoginHistory都是聚合根且属于两个不同的聚合：\n1234567891011121314151617181920212223242526272829303132333435public record User:IAggregateRoot&#123;    public Guid Id &#123; get; init; &#125;    public PhoneNumber PhoneNumber &#123; get; private set; &#125;//这里是与聚合内的值对象进行关联，可以直接引用实体对象    public UserAccessFail UserAccessFail &#123; get; private set; &#125;//这里是与聚合内的值对象进行关联，可以直接引用实体对象    private string? passwordHash;    private User()&#123;    &#125;    public User(PhoneNumber phoneNumber)&#123;        PhoneNumber = phoneNumber;        Id=Guid.NewGuid();        UserAccessFail=new UserAccessFail(this);    &#125;&#125;public record UserLoginHistory:IAggregateRoot&#123;    public long Id &#123; get; init; &#125;    public Guid? UserId &#123; get; init; &#125;//这里是与聚合外的聚合根进行关联，不能直接引用实体对象，所以引用User对象的主键作为外键    public PhoneNumber PhoneNumber &#123; get; init; &#125;//这里是与聚合内的值对象进行关联，可以直接引用实体对象    public DateTime CreateDateTime &#123; get; init; &#125;    public string Message &#123; get; init; &#125;    private UserLoginHistory() &#123; &#125;    public UserLoginHistory(Guid? userId,PhoneNumber phoneNumber,string message)&#123;        UserId= userId;        PhoneNumber= phoneNumber;        Message= message;        CreateDateTime= DateTime.Now;    &#125;&#125;\n\n跨表查询所有跨聚合的数据查询都应该尽量通过领域服务的协作来完成，而不是直接在数据库表之间进行join查询。虽然这样会有性能损失，但能降低耦合，方便微服务的拆分。但如果为了性能考虑或特殊场景下可以不遵守这些约定。\n实现实体类不要面向数据库建模\n建模时不要先考虑实体类在数据库中如何保存，比如实体类和数据表具有直接的对应关系。实体类中的属性和数据表中的列几乎完全一致。这样设计出来的类称不上“实体类”，只能被称为数据对象。\n应该在不考虑数据库实现的情况下进行领域模型建模，然后再使用FluentApi等对实体类和数据库之间做适配。在实现的时候，可能需要对建模进行妥协性修改，但这不应该在最开始就考虑\n\n7.使用MediatR发布领域事件\n有三种发布时机：\n\n在调用领域方法时发布\n缺点：可能会重复发布领域事件\n\n先注册事件，在保存实体修改时再发布\n微软示例做法：在DbContext中重写SaveChangesAsync()方法，在方法中加入发布领域事件的代码。\n\n在保存修改后发布\n缺点：需要在每次保存后都手动发布\n\n\n8.DDD的实现方式：整洁架构\n传统的三层架构特点：\n\n传统分层架构把各个组件按照“高内聚，低耦合”的原则组织到不同的项目中。\n传统的三层架构(用户界面层，业务逻辑层，数据访问层)尽管有DAL，但任然是面向数据库的思维方式，不是面向对象的。而且对于一些简单的，不包含业务逻辑的增删改查操作，仍然需要BLL进行转发，依赖关系是单向的，所以下一层的代码不能使用上一层的逻辑\n\n整洁架构（洋葱架构）\n\n内层的部分比外层部分更加的抽象，内层表达抽象，外层表达实现\n外层的代码只能调用内层的代码，内层的代码可以通过依赖注入的形式间接调用外层代码\n\n例子：读取文件然后发送邮件\n防腐层外部服务(短信服务，邮件服务，存储服务)的变化会比较频繁。把这些服务定义为接口，在内层代码中我们只定义和使用接口，在外层代码中定义接口实现。体现的仍然是洋葱架构的理念。\n工作单元\n工作单元应由应用服务层来决定，其他层（包括仓储层）不应该调用SaveChanges()方法保存对数据的修改。\n\n实际开发中通常需要在一个Controller的接口方法中调用一些领域服务，等所有领域服务完成后再调用上下文类的SaveChanges()将结果保存到数据库。\n\n若要完成SaveChanges()的自动化，可以开发一个在控制器的方法调用结束后自动调用SaveChanges()的Filter,例如：UnitOfWorkAttribute、UnitOfWorkFilter。将Filter用于控制器的Action方法\n12345678public class UnitOfWorkAttribute:Attribute&#123;    public Type[] DbContextTypes&#123;get;init;&#125;    public UnitOfWorkAttribute(params Type[] dbContextTypes)    &#123;        this.DbContextType=dbContextTypes;    &#125;&#125;\n\n应用层\n应用层主要进行的是数据的校验，请求数据的获取、领域服务返回值的显示等处理，并没有复杂的业务逻辑，因为主要的业务逻辑都被封装在领域层\n应用层是非常薄的一层，应用层主要进行安全认证、权限校验、数据校验、事务控制、工作单元控制、领域服务的调用等。从理论上讲，应用层中不应该有业务规则或业务逻辑。\n\n总结\n领域层\n领域模型与值对象的定义\n仓储接口的定义\n防腐层的定义\n领域服务的定义（领域的业务逻辑）\n\n\n基础设施层\n领域模型映射到数据库中的配置\n防腐层接口的实现\n数据库上下文与仓储层的实现\n\n\n应用层\n工作单元的处理\n领域事件的处理\n数据的校验\n领域服务的调用\n\n\n\n项目结构例子：\n\n","dateCreated":"2023-03-02T22:35:22+08:00","dateModified":"2023-03-19T22:55:13+08:00","datePublished":"2023-03-02T22:35:22+08:00","description":"DDD思想的简单介绍和参考。","headline":"DDD领域驱动设计","image":["https://s3.uuu.ovh/imgs/2023/03/19/e96be90700a246d7.jpg"],"mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com/2023/03/02/DDD%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/"},"publisher":{"@type":"Organization","name":"浅笑","sameAs":[],"image":"author.jpg","logo":{"@type":"ImageObject","url":"author.jpg"}},"url":"http://example.com/2023/03/02/DDD%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/","keywords":"DDD","thumbnailUrl":"https://s3.uuu.ovh/imgs/2023/03/19/e96be90700a246d7.jpg"}</script>
    <meta name="description" content="DDD思想的简单介绍和参考。">
<meta property="og:type" content="blog">
<meta property="og:title" content="DDD领域驱动设计">
<meta property="og:url" content="http://example.com/2023/03/02/DDD%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/index.html">
<meta property="og:site_name" content="浅笑&#39;s blog">
<meta property="og:description" content="DDD思想的简单介绍和参考。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s3.uuu.ovh/imgs/2023/03/16/e49729191ca4d5f5.png">
<meta property="og:image" content="https://s3.uuu.ovh/imgs/2023/03/19/91531fe2091a8a4c.png">
<meta property="article:published_time" content="2023-03-02T14:35:22.000Z">
<meta property="article:modified_time" content="2023-03-19T14:55:13.913Z">
<meta property="article:author" content="浅笑">
<meta property="article:tag" content="DDD">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s3.uuu.ovh/imgs/2023/03/16/e49729191ca4d5f5.png">
<meta name="twitter:creator" content="@awawg">
    
        <link rel="publisher" href="https://plus.google.com/awgwag"/>
    
    
        
    
    
        <meta property="og:image" content="http://example.com/assets/images/author.jpg"/>
    
    
        <meta property="og:image" content="https://s3.uuu.ovh/imgs/2023/03/19/e96be90700a246d7.jpg"/>
        <meta class="swiftype" name="image" data-type="enum" content="https://s3.uuu.ovh/imgs/2023/03/19/e96be90700a246d7.jpg"/>
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-jza15cykdfobov3m5dorp42elw9ecgjwnulxpcov0xrp6xyxle3civay6e3n.min.css">

    <!--STYLES END-->
    

    

    
        
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="5">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            浅笑&#39;s blog
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="打开链接: /#about"
            >
        
        
            <img class="header-picture" src="/assets/images/author.jpg" alt="作者的图片"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="5">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="/#about"
                    aria-label="阅读有关作者的更多信息"
                >
                    <img class="sidebar-profile-picture" src="/assets/images/author.jpg" alt="作者的图片"/>
                </a>
                <h4 class="sidebar-profile-name">浅笑</h4>
                
                    <h5 class="sidebar-profile-bio"><p>代码爱好者。涉及方向：Web全栈，擅长C#。</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="首页"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">首页</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="分类"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">分类</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="标签"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">标签</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-archives"
                            
                            rel="noopener"
                            title="归档"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">归档</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/csysm"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="关于作者"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">关于作者</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="5"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            DDD领域驱动设计
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2023-03-02T22:35:22+08:00">
	
		    3月 02, 2023
    	
    </time>
    
        <span>发布在 </span>
        
    <a class="category-link" href="/categories/DDD/">DDD</a>


    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <p>DDD思想的简单介绍和参考。<span id="more"></span></p>
<h2 id="1-聚合"><a href="#1-聚合" class="headerlink" title="1.聚合"></a>1.聚合</h2><hr>
<p>一个聚合(Aggregate)包含一个聚合根实体，和尽可能少的与聚合根关系紧密的普通实体，如订单(聚合根)和订单明细(普通实体)。聚合间只通过聚合根来沟通。</p>
<h2 id="2-领域服务与应用服务"><a href="#2-领域服务与应用服务" class="headerlink" title="2.领域服务与应用服务"></a>2.领域服务与应用服务</h2><hr>
<p>虽然DDD的出现早于微服务架构的兴起，但其天生适合应用于微服务架构。理想情况下一个微服务中只应该包含一个聚合，并对应一个数据库。微服务间即聚合间通过事件总线或消息中间件沟通。</p>
<p>在一个微服务中可能有以下三种服务：</p>
<ol>
<li><p>实体中的逻辑代码：管理实体的创建，实体的状态等非业务逻辑</p>
</li>
<li><p>领域服务：聚合内的业务逻辑</p>
</li>
<li><p>应用服务：聚合间、聚合与外部系统(数据库)的业务逻辑。应用服务协调多个领域服务、外部系统来完成一个用例。</p>
</li>
</ol>
<h3 id="DDD典型用例的处理流程"><a href="#DDD典型用例的处理流程" class="headerlink" title="DDD典型用例的处理流程"></a>DDD典型用例的处理流程</h3><ol>
<li>准备业务操作所需的数据</li>
<li>执行一个或者多个领域模型做出的业务操作，这些操作会修改实体状态，或者生成一些操作结果</li>
<li>把对实体的改变或操作结果应用于外部系统</li>
</ol>
<h3 id="职责划分"><a href="#职责划分" class="headerlink" title="职责划分"></a>职责划分</h3><ul>
<li>领域模型与外部系统之间不会交互，即领域服务不会涉及数据库操作</li>
<li>业务逻辑放入领域服务，而与外部系统的交互由应用服务来负责</li>
<li>领域服务不是必须的，在一些简单的业务处理中(如直接增删查)是没有领域操作的，这种情况下应用服务可以完成所有操作，不需要引入领域服务。这样可以避免过度设计。</li>
</ul>
<h3 id="仓储-Repository-和工作单元-Unit-Of-Work"><a href="#仓储-Repository-和工作单元-Unit-Of-Work" class="headerlink" title="仓储(Repository)和工作单元(Unit  Of  Work)"></a>仓储(Repository)和工作单元(Unit  Of  Work)</h3><p>仓储负责安装要求从数据库或其他外部系统中读取数据，以及把领域服务修改的数据保存回数据库</p>
<p>聚合内的数据操作是关系非常紧密的，我们要保证事务的强一致性，而聚合间的协作是关系不紧密的，因此我们只要保证事务的最终一致性即可。</p>
<p>聚合内的若干相关联操作组成一个工作单元，这些工作单元要么全部成功，要么全部失败，类似于事务。</p>
<h2 id="3-领域事件与集成事件"><a href="#3-领域事件与集成事件" class="headerlink" title="3.领域事件与集成事件"></a>3.领域事件与集成事件</h2><hr>
<p>DDD中的事件分为两种类型：</p>
<ol>
<li><p>领域事件：</p>
<p>在同一个微服务内的聚合之间的事件传递，使用进程内通信机制(MediatR)完成</p>
</li>
<li><p>集成事件：</p>
<p>跨微服务的事件传递，使用事件总线实现（RabbitMQ,Kafka等）</p>
</li>
</ol>
<h2 id="4-贫血模型与充血模型"><a href="#4-贫血模型与充血模型" class="headerlink" title="4.贫血模型与充血模型"></a>4.贫血模型与充血模型</h2><hr>
<p>贫血模型：一个类中只有属性或成员变量，没有方法</p>
<p>充血模型：一个类中既有属性，成员变量，也有方法</p>
<h3 id="在EFCore中充血模型实现的要求"><a href="#在EFCore中充血模型实现的要求" class="headerlink" title="在EFCore中充血模型实现的要求"></a>在EFCore中充血模型实现的要求</h3><p>要求：</p>
<ol>
<li><p>属性是只读的或者是只能被内部的代码修改</p>
<p>实现：把属性的set定义为private set或init，然后通过构造方法为这些属性赋值</p>
</li>
<li><p>定义有参数的构造方法，和一个私有的无参构造方法给EFCore使用</p>
<p>实现：实体类中不定义无参构造方法，只定义有意义的有参构造方法。但是要求构造方法中的参数的名字和属性一致(参数开头小写，属性开头大写)</p>
</li>
<li><p>有的成员变量没有对应属性，但是这些成员变量需要映射为数据表中的列，也就是我们需要把私有成员变量映射到数据表中的列</p>
<p>实现：不是属性的成员变量映射为数据列只需要在Config中配置：<code>builder.Property(&quot;成员变量名&quot;)</code></p>
</li>
<li><p>有的属性是只读的，也就是它的值是从数据库中读取出来，我们不能修改属性值</p>
<p>实现：EFCore中提供了”支持字段”(backing field)来支持这种写法：在配置实体类的代码中,使用<code>HasField(&quot;成员变量名&quot;)</code>来配置属性</p>
</li>
<li><p>有的属性不需要映射到数据列，仅在运行时被使用</p>
<p>实现：使用<code>Ignore()</code>来配置忽略这个属性</p>
</li>
</ol>
<h2 id="5-EFCore中使用值对象"><a href="#5-EFCore中使用值对象" class="headerlink" title="5.EFCore中使用值对象"></a>5.EFCore中使用值对象</h2><hr>
<h3 id="使用enum"><a href="#使用enum" class="headerlink" title="使用enum"></a>使用enum</h3><p>在实体类中可以使用enum，如下：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Entity</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Id &#123;<span class="keyword">get</span>;<span class="keyword">set</span>;&#125;</span><br><span class="line">    <span class="keyword">public</span> CurrencyName Currency &#123;<span class="keyword">get</span>;<span class="keyword">set</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">enum</span> CurrencyName&#123;</span><br><span class="line">    CNY,</span><br><span class="line">    USD,</span><br><span class="line">    NZD</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>不需要额外配置，直接迁移数据库即可。生成的数据库表如下，会将枚举类型作为int</p>
<table>
    <tr>
        <td>字段名</td>
        <td>Id</td>
        <td>Currency</td>
    </tr>
    <tr>
        <td>数据类型</td>
        <td>int</td>
        <td>int</td>
    </tr>


<p>可以在FluentApi中配置，将枚举类型中的值以字符串而不是int类型生成数据库，这样数据库中对应枚举的字段会保存枚举中的字符而不是0,1,2…，该字段类型也会变成nvarchar</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">EntityConfig</span>:<span class="title">IEntityTypeConfigration</span>&lt;<span class="title">Entity</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">EntityTypeBuilder&lt;Entity&gt; builder</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">    	builder.Property(e=&gt;e.Currency).HasConversion&lt;<span class="built_in">string</span>&gt;();<span class="comment">//将Currency保存为string而不是默认int</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="使用值对象"><a href="#使用值对象" class="headerlink" title="使用值对象"></a>使用值对象</h3><p>例如有一个值对象：Geo。在DDD概念中值对象不能单独存在，需要依附于某个实体</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">record</span> <span class="title">Geo</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> Latitude &#123;<span class="keyword">get</span>;<span class="keyword">init</span>;&#125;<span class="comment">//经度</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> Longitude &#123;<span class="keyword">get</span>;<span class="keyword">init</span>;&#125;<span class="comment">//维度</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Geo</span>(<span class="params"><span class="built_in">double</span> Latitude,<span class="built_in">double</span> Longitude</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.Latitude=Latitude;</span><br><span class="line">        <span class="keyword">this</span>.Longitude=Longitude;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Geo值对象依附于Shop实体。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Shop</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Id &#123;<span class="keyword">get</span>;<span class="keyword">set</span>;&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123;<span class="keyword">get</span>;<span class="keyword">set</span>;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> Geo Location &#123;<span class="keyword">get</span>;<span class="keyword">set</span>;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>需要使用FluentApi配置：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ShopConfig</span>:<span class="title">IEntityTypeConfigration</span>&lt;<span class="title">Shop</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">EntityTypeBuilder&lt;Shop&gt; builder</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">    	builder.OwnsOne(x=&gt;x.Location);<span class="comment">//使用OwnsOne配置</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>迁移后生成的数据库表会将值对象Geo中的两个属性展开，作为Shop表的两个字段</p>
<table>
    <tr>
        <td>字段名</td>
        <td>Id</td>
        <td>Name</td>
        <td>Latitude</td>
        <td>Longitude</td>
    </tr>
    <tr>
        <td>数据类型</td>
        <td>int</td>
        <td>string</td>
        <td>double</td>
        <td>double</td>
    </tr>
## 6.DDD在EFCore中的实现


<hr>
<ol>
<li><p>在聚合根实体中定义对聚合内所有实体进行操作的方法</p>
</li>
<li><p><strong>只在DbContext中为聚合根注册DbSet</strong>，EFCore会为与聚合根关联的实体自动生成数据库表</p>
</li>
<li><p>建议将一个微服务中的所有聚合放在一个DbContext中，而不是为每个聚合单独创建一个DbContext，这样可以避免跨DbContext进行操作</p>
</li>
<li><p>建议定义一个IAggregateRoot接口，所有聚合根实现该接口</p>
</li>
<li><p><strong>跨聚合进行实体引用，只能引用聚合根实体，并且只能引用根实体的主键作为外键，而不是根实体对象。</strong>这样便于以后拆分微服务，因为一般每个微服务都管理自己的数据库。此外，聚合内的实体进行关联所需的数据库外键可以保留，而聚合间因为跨数据库所以天生不存在外键关联。</p>
<p>例如，User与UserLoginHistory都是聚合根且属于两个不同的聚合：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">record</span> <span class="title">User</span>:<span class="title">IAggregateRoot</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> Guid Id &#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> PhoneNumber PhoneNumber &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;<span class="comment">//这里是与聚合内的值对象进行关联，可以直接引用实体对象</span></span><br><span class="line">    <span class="keyword">public</span> UserAccessFail UserAccessFail &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;<span class="comment">//这里是与聚合内的值对象进行关联，可以直接引用实体对象</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span>? passwordHash;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">User</span>()</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span>(<span class="params">PhoneNumber phoneNumber</span>)</span>&#123;</span><br><span class="line">        PhoneNumber = phoneNumber;</span><br><span class="line">        Id=Guid.NewGuid();</span><br><span class="line">        UserAccessFail=<span class="keyword">new</span> UserAccessFail(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">record</span> <span class="title">UserLoginHistory</span>:<span class="title">IAggregateRoot</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> Guid? UserId &#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125;<span class="comment">//这里是与聚合外的聚合根进行关联，不能直接引用实体对象，所以引用User对象的主键作为外键</span></span><br><span class="line">    <span class="keyword">public</span> PhoneNumber PhoneNumber &#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125;<span class="comment">//这里是与聚合内的值对象进行关联，可以直接引用实体对象</span></span><br><span class="line">    <span class="keyword">public</span> DateTime CreateDateTime &#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Message &#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">UserLoginHistory</span>()</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UserLoginHistory</span>(<span class="params">Guid? userId,PhoneNumber phoneNumber,<span class="built_in">string</span> message</span>)</span>&#123;</span><br><span class="line">        UserId= userId;</span><br><span class="line">        PhoneNumber= phoneNumber;</span><br><span class="line">        Message= message;</span><br><span class="line">        CreateDateTime= DateTime.Now;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="跨表查询"><a href="#跨表查询" class="headerlink" title="跨表查询"></a>跨表查询</h3><p>所有跨聚合的数据查询都应该尽量通过领域服务的协作来完成，而不是直接在数据库表之间进行join查询。虽然这样会有性能损失，但能降低耦合，方便微服务的拆分。但如果为了性能考虑或特殊场景下可以不遵守这些约定。</p>
<h3 id="实现实体类不要面向数据库建模"><a href="#实现实体类不要面向数据库建模" class="headerlink" title="实现实体类不要面向数据库建模"></a>实现实体类不要面向数据库建模</h3><ol>
<li>建模时不要先考虑实体类在数据库中如何保存，比如实体类和数据表具有直接的对应关系。实体类中的属性和数据表中的列几乎完全一致。这样设计出来的类称不上“实体类”，只能被称为数据对象。</li>
<li>应该在不考虑数据库实现的情况下进行领域模型建模，然后再使用FluentApi等对实体类和数据库之间做适配。在实现的时候，可能需要对建模进行妥协性修改，但这不应该在最开始就考虑</li>
</ol>
<h2 id="7-使用MediatR发布领域事件"><a href="#7-使用MediatR发布领域事件" class="headerlink" title="7.使用MediatR发布领域事件"></a>7.使用MediatR发布领域事件</h2><hr>
<p>有三种发布时机：</p>
<ol>
<li><p>在调用领域方法时发布</p>
<p>缺点：可能会重复发布领域事件</p>
</li>
<li><p>先注册事件，在保存实体修改时再发布</p>
<p>微软示例做法：在DbContext中重写SaveChangesAsync()方法，在方法中加入发布领域事件的代码。</p>
</li>
<li><p>在保存修改后发布</p>
<p>缺点：需要在每次保存后都手动发布</p>
</li>
</ol>
<h2 id="8-DDD的实现方式：整洁架构"><a href="#8-DDD的实现方式：整洁架构" class="headerlink" title="8.DDD的实现方式：整洁架构"></a>8.DDD的实现方式：整洁架构</h2><hr>
<p>传统的三层架构特点：</p>
<ol>
<li>传统分层架构把各个组件按照“高内聚，低耦合”的原则组织到不同的项目中。</li>
<li>传统的三层架构(用户界面层，业务逻辑层，数据访问层)尽管有DAL，但任然是面向数据库的思维方式，不是面向对象的。而且对于一些简单的，不包含业务逻辑的增删改查操作，仍然需要BLL进行转发，依赖关系是单向的，所以下一层的代码不能使用上一层的逻辑</li>
</ol>
<h3 id="整洁架构（洋葱架构）"><a href="#整洁架构（洋葱架构）" class="headerlink" title="整洁架构（洋葱架构）"></a>整洁架构（洋葱架构）</h3><p><img src="https://s3.uuu.ovh/imgs/2023/03/16/e49729191ca4d5f5.png"></p>
<ol>
<li>内层的部分比外层部分更加的抽象，内层表达抽象，外层表达实现</li>
<li>外层的代码只能调用内层的代码，内层的代码可以通过依赖注入的形式<strong>间接</strong>调用外层代码</li>
</ol>
<p>例子：读取文件然后发送邮件</p>
<h3 id="防腐层"><a href="#防腐层" class="headerlink" title="防腐层"></a>防腐层</h3><p>外部服务(短信服务，邮件服务，存储服务)的变化会比较频繁。把这些服务定义为接口，在内层代码中我们只定义和使用接口，在外层代码中定义接口实现。体现的仍然是洋葱架构的理念。</p>
<h3 id="工作单元"><a href="#工作单元" class="headerlink" title="工作单元"></a>工作单元</h3><ol>
<li><p>工作单元应由应用服务层来决定，<strong>其他层（包括仓储层）不应该调用SaveChanges()方法保存对数据的修改</strong>。</p>
</li>
<li><p>实际开发中通常需要在一个Controller的接口方法中调用一些领域服务，等所有领域服务完成后再调用上下文类的SaveChanges()将结果保存到数据库。</p>
</li>
<li><p>若要完成SaveChanges()的自动化，可以开发一个在控制器的方法调用结束后自动调用SaveChanges()的Filter,例如：UnitOfWorkAttribute、UnitOfWorkFilter。将Filter用于控制器的Action方法</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UnitOfWorkAttribute</span>:<span class="title">Attribute</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> Type[] DbContextTypes&#123;<span class="keyword">get</span>;<span class="keyword">init</span>;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UnitOfWorkAttribute</span>(<span class="params"><span class="keyword">params</span> Type[] dbContextTypes</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.DbContextType=dbContextTypes;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="应用层"><a href="#应用层" class="headerlink" title="应用层"></a>应用层</h3><ol>
<li>应用层主要进行的是数据的校验，请求数据的获取、领域服务返回值的显示等处理，并没有复杂的业务逻辑，因为主要的业务逻辑都被封装在领域层</li>
<li>应用层是非常薄的一层，应用层主要进行安全认证、权限校验、数据校验、事务控制、工作单元控制、领域服务的调用等。从理论上讲，应用层中不应该有业务规则或业务逻辑。</li>
</ol>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul>
<li>领域层<ol>
<li>领域模型与值对象的定义</li>
<li>仓储接口的定义</li>
<li>防腐层的定义</li>
<li>领域服务的定义（领域的业务逻辑）</li>
</ol>
</li>
<li>基础设施层<ol>
<li>领域模型映射到数据库中的配置</li>
<li>防腐层接口的实现</li>
<li>数据库上下文与仓储层的实现</li>
</ol>
</li>
<li>应用层<ol>
<li>工作单元的处理</li>
<li>领域事件的处理</li>
<li>数据的校验</li>
<li>领域服务的调用</li>
</ol>
</li>
</ul>
<p>项目结构例子：</p>
<p><img src="https://s3.uuu.ovh/imgs/2023/03/19/91531fe2091a8a4c.png"></p>

            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">标签</span><br/>
                
    <a class="tag tag--primary tag--small t-none-link" href="/tags/DDD/" rel="tag">DDD</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2023/03/14/RabbitMQ%E4%BD%BF%E7%94%A8/"
                    data-tooltip="RabbitMQ使用"
                    aria-label="上一篇: RabbitMQ使用"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">上一篇</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2023/02/09/%E4%BD%BF%E7%94%A8MediatR%E5%8F%91%E5%B8%83%E9%A2%86%E5%9F%9F%E4%BA%8B%E4%BB%B6/"
                    data-tooltip="使用MediatR发布领域事件"
                    aria-label="下一篇: 使用MediatR发布领域事件"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">下一篇</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Diesen Beitrag teilen"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=http://example.com/2023/03/02/DDD%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/"
                    title="分享到 Twitter"
                    aria-label="分享到 Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="http://service.weibo.com/share/share.php?&amp;title=http://example.com/2023/03/02/DDD%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/"
                    title="分享到 Weibo"
                    aria-label="分享到 Weibo"
                >
                    <i class="fab fa-weibo" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="http://connect.qq.com/widget/shareqq/index.html?url=http://example.com/2023/03/02/DDD%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/&amp;title=DDD领域驱动设计"
                    title="分享到 QQ"
                    aria-label="分享到 QQ"
                >
                    <i class="fab fa-qq" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Nach oben">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2023 浅笑. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2023/03/14/RabbitMQ%E4%BD%BF%E7%94%A8/"
                    data-tooltip="RabbitMQ使用"
                    aria-label="上一篇: RabbitMQ使用"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">上一篇</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2023/02/09/%E4%BD%BF%E7%94%A8MediatR%E5%8F%91%E5%B8%83%E9%A2%86%E5%9F%9F%E4%BA%8B%E4%BB%B6/"
                    data-tooltip="使用MediatR发布领域事件"
                    aria-label="下一篇: 使用MediatR发布领域事件"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">下一篇</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Diesen Beitrag teilen"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=http://example.com/2023/03/02/DDD%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/"
                    title="分享到 Twitter"
                    aria-label="分享到 Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="http://service.weibo.com/share/share.php?&amp;title=http://example.com/2023/03/02/DDD%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/"
                    title="分享到 Weibo"
                    aria-label="分享到 Weibo"
                >
                    <i class="fab fa-weibo" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="http://connect.qq.com/widget/shareqq/index.html?url=http://example.com/2023/03/02/DDD%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/&amp;title=DDD领域驱动设计"
                    title="分享到 QQ"
                    aria-label="分享到 QQ"
                >
                    <i class="fab fa-qq" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Nach oben">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="5">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://twitter.com/intent/tweet?text=http://example.com/2023/03/02/DDD%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/"
                        aria-label="分享到 Twitter"
                    >
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>分享到 Twitter</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="http://service.weibo.com/share/share.php?&amp;title=http://example.com/2023/03/02/DDD%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/"
                        aria-label="分享到 Weibo"
                    >
                        <i class="fab fa-weibo" aria-hidden="true"></i><span>分享到 Weibo</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="http://connect.qq.com/widget/shareqq/index.html?url=http://example.com/2023/03/02/DDD%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/&amp;title=DDD领域驱动设计"
                        aria-label="分享到 QQ"
                    >
                        <i class="fab fa-qq" aria-hidden="true"></i><span>分享到 QQ</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/author.jpg" alt="作者的图片"/>
        
            <h4 id="about-card-name">浅笑</h4>
        
            <div id="about-card-bio"><p>代码爱好者。涉及方向：Web全栈，擅长C#。</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>Student</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                Wuhan
            </div>
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/background.png');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-r1cy8sodc70sqdustknxebxnaszsgd8lhjzdxnsc5syn7siu0apth4cih47e.min.js"></script>

<!--SCRIPTS END-->


    




    </body>
</html>
